const axios = require("axios"); async function testCloseChannel() { console.log("🧪 测试关闭通道API..."); try { console.log("1. 检查当前通道列表..."); const channels = await axios.get("http://localhost:3000/api/lnd/channels"); console.log("活跃通道:", channels.data); if (channels.data.channels.length === 0) { console.log("❌ 当前没有活跃通道可以关闭"); console.log("�� 需要先开通道才能测试关闭功能"); return; } const channel = channels.data.channels[0]; const channelPoint = `${channel.channel_point}:${channel.output_index}`; console.log("2. 尝试关闭通道:", channelPoint); const closeResult = await axios.post("http://localhost:3000/api/lnd/closechannel", { channel_point: channelPoint, force: false, delivery_address: "", sat_per_vbyte: "1" }); console.log("✅ 关闭通道成功:", closeResult.data); } catch (error) { if (error.response) { console.log("API响应:", error.response.status, error.response.data); } else { console.log("错误:", error.message); } } } testCloseChannel();
