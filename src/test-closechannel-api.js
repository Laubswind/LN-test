const axios = require("axios"); async function testCloseChannel() { console.log("ğŸ§ª æµ‹è¯•å…³é—­é€šé“API..."); try { console.log("1. æ£€æŸ¥å½“å‰é€šé“åˆ—è¡¨..."); const channels = await axios.get("http://localhost:3000/api/lnd/channels"); console.log("æ´»è·ƒé€šé“:", channels.data); if (channels.data.channels.length === 0) { console.log("âŒ å½“å‰æ²¡æœ‰æ´»è·ƒé€šé“å¯ä»¥å…³é—­"); console.log("ï¿½ï¿½ éœ€è¦å…ˆå¼€é€šé“æ‰èƒ½æµ‹è¯•å…³é—­åŠŸèƒ½"); return; } const channel = channels.data.channels[0]; const channelPoint = `${channel.channel_point}:${channel.output_index}`; console.log("2. å°è¯•å…³é—­é€šé“:", channelPoint); const closeResult = await axios.post("http://localhost:3000/api/lnd/closechannel", { channel_point: channelPoint, force: false, delivery_address: "", sat_per_vbyte: "1" }); console.log("âœ… å…³é—­é€šé“æˆåŠŸ:", closeResult.data); } catch (error) { if (error.response) { console.log("APIå“åº”:", error.response.status, error.response.data); } else { console.log("é”™è¯¯:", error.message); } } } testCloseChannel();
